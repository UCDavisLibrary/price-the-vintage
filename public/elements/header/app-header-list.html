
<dom-module id="app-header-list">
  <template>
    <style include="shared-styles"></style>
    <style>
      :host {
        display: block;
      }

      #searchContainer {
        margin: 0 10%;
        position: absolute;
        background-color: white;
        color: black;
        padding: 10px;
        z-index: 10;
        top: 65px;
        width: 80%;
      }
      
      paper-input {
        --paper-input-container-color: white;
        --paper-input-container-focus-color: white;
        --paper-input-container-input-color: white;
        color: white;
        --paper-input-container : {
          margin: 0;
        }
      }

      paper-dialog {
        color: black;
      }

      #outer-input {
        padding: 0 10px 0 5px;
      }
      #input {
        display: block;
        padding: 5px;
        font-size: 22px;
        width: 100%;
        background: var(--dark-primary-color);
        color: white;
        border: 2px solid white;
        border-radius: 4px;
      }
      #input::-webkit-input-placeholder { /* Chrome/Opera/Safari */
        color: white;
      }
      #input::-moz-placeholder { /* Firefox 19+ */
        color: white;
      }
      #input:-ms-input-placeholder { /* IE 10+ */
        color: white;
      }
      #input:-moz-placeholder { /* Firefox 18- */
        color: white;
      }
    </style>

    <div class="layout center">
      <div hidden$="[[!searchBoxActive]]">
        <iron-icon icon="search"></iron-icon>
      </div>
      <img 
          alt="Application Icon"
          src="/images/wine-icon-48.png" 
          srcset="/images/wine-icon-48.png 1x, /images/wine-icon-64.png 1.5x, /images/wine-icon-96.png 2x"  
          hidden$="[[searchBoxActive]]" 
          style="padding-right: 10px" />
      <div class="flex">
        
        <h2 hidden$="[[searchBoxActive]]">
          Price the Vintage <span style="font-size:12px">Alpha</span>
        </h2>

        <div id="outer-input" hidden$="[[!searchBoxActive]]">
          <input id="input" on-keyup="_searchCatalogsDelay" placeholder="Search Catalogs" />
        </div>

      </div>
      <div hidden$="[[!searchBoxActive]]">
        <paper-icon-button state="list" icon="close" on-click="_toggleSearch"></paper-icon-button>
      </div>
      <div hidden$="[[searchBoxActive]]">
        <paper-icon-button state="list" icon="search" on-click="_toggleSearch"></paper-icon-button>
      </div>
    </div>

  </template>
  <script>

    class AppHeaderList extends 
          Mixin(Polymer.Element)
          .with(EventBusMixin, CatalogsMixin, AppStateMixin) {

      static get is() { return 'app-header-list'; }

      static get properties() {
        return {
            searchBoxActive : {
              type : Boolean,
              value : false
            },
            appState : {
              type : Object,
              value : function() {
                return {}
              }
            }
          }
      }

      _searchCatalogsDelay() {
        this.debounce('searchCatalog', () => {
          this._searchCatalogs({
            q : this.$.input.value,
            exact : this.appState.searchExact
          });
        }, 500);
      }

      _toggleSearch() {
        this.searchBoxActive = !this.searchBoxActive;

        if( this.searchBoxActive ) {
          this.$.input.focus();
        } else {
          this.$.input.value = '';
          this.eventLoop.searchCatalogs.req();
        }

        this._setAppState({
          searchBoxActive : this.searchBoxActive
        });
      }
    }

    window.customElements.define(AppHeaderList.is, AppHeaderList);
  </script>
</dom-module>
