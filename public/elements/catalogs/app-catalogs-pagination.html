
<dom-module id="app-catalogs-pagination">
  <template>
    <style include="shared-styles"></style>
    <style>
      :host {
        display: block;
      }

      paper-icon-button {
        color: var(--default-primary-color);
      }
    </style>

    <div class="layout center">
      <paper-icon-button 
        icon="arrow-back" 
        on-click="back"
        disabled$="[[backDisabled]]">
      </paper-icon-button>

      <div class="flex" style="text-align: center; font-style:italic">
        <span id="text" hidden$="[[!showTotal]]" >Showing [[displayStart]] to [[displayStop]] of [[results.total]]</span>
      </div>
      
      <paper-icon-button 
        icon="arrow-forward" 
        on-click="forward"
        disabled$="[[forwardDisabled]]">
      </paper-icon-button>
    </div>
    
  </template>
  <script>

    class AppCatalogsPagination extends 
      Mixin(Polymer.Element)
      .with(EventBusMixin, AppStateMixin, CatalogsMixin) {

      static get is() { return 'app-catalogs-pagination' } 

      static get properties() {
        return {
          results : {
            type : Object,
            value : null,
            observer : '_onUpdate'
          },
          showTotal : {
            type : Boolean,
            value : false
          },
          itemsPerPage : {
            type : Number,
            value : 12
          },
          searchText : {
            type : String,
            value : ''
          },
          backDisabled : {
            type : Boolean,
            value : false
          },
          forwardDisabled : {
            type : Boolean,
            value : false
          }
        }
      }

      _onUpdate() {
        if( !this.results ) {
          this.$.text.style.display = 'none';
          this.backDisabled = true;
          this.forwardDisabled = true;
          return;
        }
        this.$.text.style.display = 'block';

        if( this.results.stop === 0 ) {
          this.displayStart = 0;
          this.displayStop = 0;
        } else {
          this.displayStart = (this.results.start || 0)+1;
          this.displayStop = this.results.stop+1;
        }

        this.backDisabled = (this.results.start === 0) ? true : false;
        this.forwardDisabled = (this.results.total <= this.results.stop) ? true : false;
      }

      forward() {
        this._search(this.results.start+this.itemsPerPage);
      }

      back() {
        this._search(this.results.start-this.itemsPerPage);
      }

      _onAppStateUpdate(e) {
        this.searchText = e.searchText;
      }
      
      _search(offset) {
        this._searchCatalogs({
            q : this.searchText,
            exact : true,
            limit : this.itemsPerPage,
            offset : offset
        });
      }
    
    }
    window.customElements.define(AppCatalogsPagination.is, AppCatalogsPagination);
  </script>
</dom-module>
