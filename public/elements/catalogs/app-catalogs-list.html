<link rel="import" href="app-catalog-thumbnail.html">
<link rel="import" href="app-catalogs-search-results.html">
<link rel="import" href="app-catalogs-pagination.html">

<!--
  This is the main catalog list view.  Contains a list of catalog cards as well as 
  the bottom (popup) section of the search results.
-->
<dom-module id="app-catalogs-list" >
  <template>
      <style include="shared-styles"></style>
      <style>
        :host {
          display: block;
          position: absolute;
          left: 0;
          right: 0;
          top: 0;
          bottom:0;
        }

        .loadingIndicator {
          font-size: 16px;
          text-align: center;
          height: 60px;
        }

        .loadingIndicator paper-spinner {
          margin-right: 20px;
          vertical-align: middle;
        }

        .pages > .detail {
          position: absolute;
          bottom: 0;
          left: 0;
          right: 0;
          background: rgba(0, 0, 0, .8);
          color: white;
          font-weight: 100;
          padding: 5px;
          opacity: 1;
          transition: opacity 0.1s;
        }

        .grid-card {
          cursor: pointer;
        }

        .detail {
          padding: 5px;
        }

        paper-fab {
          width: 32px; 
          height: 32px;
          padding: 5px;
        }

        [loading-state="loading"] {
          text-align: center;
          margin-top: 100px;
        }

        app-catalogs-search-results {
          position: absolute;
          left: 0;
          top: 0;
          right: 0;
          z-index: 50;
        }

        paper-material {
          padding: 5px 10px;
          margin: 5px;
          background: white;
        }
      </style>

      <!-- This is the popup section of the catalog search results -->
      <!--<app-catalogs-search-results></app-catalogs-search-results>-->


      <div class="layout" style="justify-content: center">

        <div>
          <div style="text-align:center; overflow: auto" id="introText">
            <div style="max-width: 800px; text-align: left; margin: auto;">

              <p>Browse through our collection of Sherry-Lehmann catalogs. As you do, you might notice a lot of wine prices. Help us make it searchable transcribing the prices that you see on the pages.</p>

            </div>
          </div>

          <app-catalogs-pagination results="[[results]]" show-total></app-catalogs-pagination>
          <div style=" min-height: 685px;">
            <div loading-state="loaded" style="max-width: 800px; text-align: center" >
                <template is="dom-repeat" items="[[results.results]]" as="catalog">
                  <app-catalog-thumbnail 
                      style="display:inline-block"
                      class="grid-thumbnail" 
                      active="[[active]]"
                      catalog="[[catalog]]"
                      api-host="[[apiHost]]">
                    </app-catalog-thumbnail>
                </template>
                
            </div>

            <div loading-state="loading">
              <paper-spinner active></paper-spinner>
            </div>

            <div loading-state="error">
              Failed to load wine catalogs :(
            </div>
          </div>
          <app-catalogs-pagination results="[[results]]"></app-catalogs-pagination>
        </div>

      </div>

      <div style="text-align:center; overflow: auto" id="introText">
        <div style="max-width: 800px; text-align: left; margin: auto;">
          <h2>About the Project</h2>
          <paper-material>
            <p>We’ve digitized hundreds of catalogs from the famed distributor, Sherry-Lehmann. From the late 1930s through the 1950s, these beautiful illustrated brochures list prices from thousands of now rare bottles, helping to chart America’s appreciation for wine from France, Spain, Italy, and beyond.</p>

            <p>Through a new enhanced crowdsourcing application, we’re lifting the prices of these wines off the page, allowing scholars and consumers to chart the ever-changing tastes of America over time.</p>

            <p>By helping us create a database of these historic wine prices, we’ll be able to assist researchers around the world — economists, historians, sommeliers, oenologists, even novelists looking for period details — this online resource will fill a gap in their understanding of wine history.</p>

            <p>Ready to help? Get started now! <a href="https://catalogs.wine-qa.library.ucdavis.edu/">https://catalogs.wine-qa.library.ucdavis.edu/</a></p>
          </paper-material>

          

          <h2>What’s Next?</h2>
          <paper-material>
            <p>Once all the text on the labels has been transcribed, visitors to the site will be able to search through the collection using keywords, like ‘Pinot’.</p>

            <p>We’ll also be able to unite them with the pictures of the labels of these wines - bottles that Maynard Amerine and his colleagues might well have held in their hands - showing them in the context of the actual menus where they would have been enjoyed!</p>
          </paper-material>

          <h2>Questions? Comments?</h2>
          <paper-material>
            <p>If you have questions about the project or how to use this site, you can reach us at labelthis@ucdavis.edu.
            To learn more about opportunities to support this project or the UC Davis Library’s world-class wine archives, contact Jean Korinke, Director of Development, at <a href="mailto:jfkorinke@ucdavis.edu">jfkorinke@ucdavis.edu</a> or (530) 752-2422.
            For media inquiries, please contact Jessica Nusbaum, at <a href="mailto:jlnusbaum@ucdavis.edu">jlnusbaum@ucdavis.edu</a> or (530) 752-4145.</p>
          </paper-material>


          <h2>The Team</h2>
          <paper-material>
            <p>
              <div><b>Peter Brantley</b> – Director of Online Strategy, UC Davis Libraries</div>
              <div><b>Amy Azzarito</b> — Product Manager, Assistant Director of Online Strategy, UC Davis Libraries</div>
              <div><b>Neil Weingarten</b> – Project Manager</div>
              <div><b>Pablo Defendini</b> – UX Designer</div>
              <div><b>Quinn Hart</b> — Digital Applications Manager</div>
              <div><b>Justin Merz</b> — Application Developer.</div>
              <div><b>Axel Borg</b> — Project Curator and Subject Specialist</div>
              <div>Special thanks to the Social Apps Lab at CITRIS.</div>
            </p>
          </paper-material>
        </div>
      </div>

      <div style="text-align: center; padding: 25px 0;">
        <h3>Powered By</h3>
        <img src="/images/library.png" style="width:100%; max-width: 350px;" alt="UC Davis Library logo" />
      </div>

  </template>

  <script>

    class AppCatalogsList extends 
        Mixin(Polymer.Element)
        .with(EventBusMixin, ToggleStateMixin, CatalogsMixin, ConfigMixin) {

      static get is() { return 'app-catalogs-list' }

      static get properties() {
        return {
            /**
             * Current list of catalog results
             **/
            results : {
              type : Object,
              value : function() {
                return null
              }
            }
          }
      }

      ready() {
        super.ready();

        // start of in the loading UI state
        this.toggleState('loading', 'loading-state');
      }
      
      _onActive() {
        if( !this.active ) return;

        // on active, start a catalog search for current search state
        if( this.results ) return;

        this._searchCatalogs({
          offset : 0,
          limit : 12
        });
      }

      _onCatalogSearchUpdate(e) {

        if( e.state === 'loading' ) {
          this.toggleState('loading', 'loading-state');
          return;
        }

        if( e.state !== 'loaded' ) return;
        
        this.results = e.results;
        this.toggleState('loaded', 'loading-state');
      }

    }
    window.customElements.define(AppCatalogsList.is, AppCatalogsList);
  </script>

</dom-module>
