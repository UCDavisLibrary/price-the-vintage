
<dom-module id="app-admin-interface">
  <template>
    <style>
      :host {
        display: block;
      }
    </style>

    <app-review-marks page="reviewMarks" active$="[[active]]"></app-review-marks>

  </template>
  <script>

    class AppAdminInterface extends 
      Mixin(Polymer.Element)
      .with(EventBusMixin, AuthMixin, AppStateMixin) {

      static get is() { return 'app-admin-interface' };

      static get properties() {
        return {
          selected : {
            type : Number,
            value : false
          }
        }
      }

      _onAuthUpdate(e) {
        if( e.state === 'pending' ) return;
        this.auth = e;
        this._onUpdate();
      }

      _onAppStateUpdate(e) {
        this.appState = e;
        if( this.appState.section !== 'admin' ) return;
        this._onUpdate();
      }

      _onUpdate() {
        if( !this.active ) return;
        this.debounce('_onUpdate', this._onUpdateAsync.bind(this), 100);
      }

      _onUpdateAsync() {
        if( this.auth.state === 'notLoggedIn' || !this.auth.user ) {
          this.emit('ui-set-location', '');
          return;
        } else if( !this.auth.user.isAdmin ) {
          this.emit('ui-set-location', '');
          return;
        }
      }

    }

    window.customElements.define(AppAdminInterface.is, AppAdminInterface);
  </script>
</dom-module>
